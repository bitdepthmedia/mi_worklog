- 2025-08-17 15:34:12 EDT – Removed webapp manifest section from [`scripts/appsscript.json`](scripts/appsscript.json): eliminated the entire "webapp" section containing `executeAs: USER_DEPLOYING` and `access: ANYONE`; removed unnecessary public web app exposure for the bound-sheet sidebar; improved security posture by minimizing attack surface; prevented accidental public deployments; applied principle of least privilege while maintaining existing sidebar functionality.

- 2025-08-17 15:31:29 EDT – Unified sheet name constants using CONFIG.SHEETS across [`scripts/bootstrap.gs`](scripts/bootstrap.gs), [`scripts/services.pars.gs`](scripts/services.pars.gs), [`scripts/services.settings.gs`](scripts/services.settings.gs), [`scripts/services.audit.gs`](scripts/services.audit.gs), [`scripts/services.caseload.gs`](scripts/services.caseload.gs), and [`scripts/services.validation.gs`](scripts/services.validation.gs): replaced 17 hardcoded sheet name references (bootstrap: 6, pars: 1, settings: 1, audit: 1, caseload: 3, validation: 5) with `CONFIG.SHEETS`; implemented consistent usage pattern, added error handling for missing values, and removed hardcoded fallbacks.

- 2025-08-17 15:23:25 EDT – Implemented PARSService.classify and PARSService.closeWeek ([`scripts/services.pars.gs`](scripts/services.pars.gs)): PARS category classification based on activity codes; weekly aggregation grouped by staff and PARS classification; immutable report sheet generation ("Reports - Week {YYYY-MM-DD}") with sheet protection; batch operations and locking for concurrency; audit trail integration via AuditService.log; error handling for duplicate weeks and data validation.

- 2025-08-17 15:18:03 EDT – Enhanced Sidebar.html ([`scripts/Sidebar.html`](scripts/Sidebar.html)): added comprehensive client-side validation with required fields and inline error messages; implemented server error handling with withFailureHandler and inline error display; integrated with Settings for min_increment and validation rules; enhanced user feedback with loading states and inline status banners; improved form state management with submission prevention and state preservation; replaced generic alerts with accessible, inline messaging; added visual indicators for required fields and validation states.

- 2025-08-17 15:11:11 EDT – Implemented CaseloadService.listStudents ([`scripts/services.caseload.gs`](scripts/services.caseload.gs)): effective-dated filtering of caseload by staff ID and date ranges, staff context resolution via Session.getActiveUser().getEmail(), student data integration joining Caseload and Students sheets, caching with 15-minute TTL scoped per staff and date, comprehensive error handling with graceful fallbacks, and helper functions for date parsing, staff lookup, and sheet data reading.

- 2025-08-17 15:06:27 EDT – Implemented SettingsService.listActivities ([`scripts/services.settings.gs`](scripts/services.settings.gs)): read activities from Settings sheet, caching with 10-minute TTL via PropertiesService, robust error handling with fallback to default activities, added helper functions for Settings key reading, JSON parsing, and cache management, integrated with `AuditService.log` for error tracking.
- 2025-08-17 15:02:14 EDT – Enhanced ValidationService.validateEntry ([`scripts/services.validation.gs`](scripts/services.validation.gs)): implemented comprehensive server-side validation including role/activity allowability via Settings integration, overlap detection for same user/date entries, permissions validation for staff/student contexts, data integrity checks for student IDs, activity codes, date ranges, and minute values, and integrated with `AuditService.log` for validation failure tracking.
- 2025-08-17 14:54:19 EDT – Implemented audit system ([`scripts/Code.gs`](scripts/Code.gs), [`scripts/bootstrap.gs`](scripts/bootstrap.gs), [`scripts/services.audit.gs`](scripts/services.audit.gs)): added `CONFIG.SHEETS.AUDIT = "Audit"`, created Audit sheet in bootstrap, implemented `AuditService.log` with schema (Timestamp, User, Action, Payload, Checksum), and added lazy sheet creation with proper error handling.
- 2025-08-17 14:48:13 EDT – Fixed lock handling in `WorklogService.saveEntry` (`scripts/services.worklog.gs`): implemented correct lock lifecycle by storing the lock reference in a variable and wrapping processing in a `try/finally` block to guarantee lock release.
